# Deployment notes for PythonAnywhere

This project is a small Flask app for generating quotations and PDF documents.

## Environment variables (set on PythonAnywhere **Web -> Environment variables**)
- `SECRET_KEY` — secret used by Flask sessions and CSRF protection. **Required in production.**
- `ADMIN_USER` — admin username (default: `Drewkam`).
- `ADMIN_PASSWORD_HASH` — password hash generated by `werkzeug.security.generate_password_hash()` (preferred)
- `ADMIN_PASSWORD` — (optional) plain password (will be hashed on startup). Use only for quick setup, not recommended long-term.
- `FLASK_DEBUG` — set to `1` to enable debug when running via `python app.py` locally. On PythonAnywhere you should keep it off.
- `SESSION_FILE_DIR` — optional: directory for filesystem-based session files. By default it uses `instance/flask_session`.

## Installation
1. Set up virtualenv and install dependencies:
```
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

2. Configure the Web app in PythonAnywhere:
- Source folder: your repository folder
- Virtualenv: path to your venv
- WSGI configuration: point to the `app` object in `app.py`. Example edit to WSGI file:
```python
import sys
sys.path.insert(0, '/home/yourusername/path/to/project')
from app import app as application
```
- Static files: map `/static` to your project's `static/` folder.

3. Set the required environment variables in the Web tab.

4. Ensure fonts and images are present in `static/`:
- `static/images/header.jpg` — header used in PDFs
- `static/dejavu-fonts-ttf-2.37/ttf/DejaVuSans.ttf` or `DejaVuSans.ttf` available in project root for correct PDF fonts.

5. Logs: check error logs if PDFs or sessions fail.

## Notes
- The app uses server-side sessions (Flask-Session, filesystem) to avoid cookie size limits—configure `SESSION_FILE_DIR` if needed.
- An admin panel is available at `/admin` (requires login). Use it to edit `data/*.json` files and `data/obrobki/*.json` (edits are validated as JSON and a `.bak` backup is created automatically).
- For production, always set `SECRET_KEY` and provide `ADMIN_PASSWORD_HASH` (use `werkzeug.security.generate_password_hash`).
- If you need persistent storage for orders, consider adding a small SQLite DB.

---
